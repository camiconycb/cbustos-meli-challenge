"use strict";

var _mongoose = _interopRequireDefault(require("mongoose"));

var _koaBody = _interopRequireDefault(require("koa-body"));

var _koa = _interopRequireDefault(require("koa"));

var _routes = _interopRequireDefault(require("./routes"));

var _enviroment = _interopRequireDefault(require("./config/enviroment"));

var _errors = _interopRequireDefault(require("./config/errors"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const env = (0, _enviroment.default)();
const app = new _koa.default();
const router = (0, _routes.default)();

if (env.db.user === undefined || env.db.password === undefined || env.db.port === undefined) {
  throw new Error(_errors.default.MISSING_ENV_VARIABLES);
}

_mongoose.default.connect(`mongodb://${env.db.user}:${env.db.password}@mongo:${env.db.port}/`, {
  useNewUrlParser: true,
  useUnifiedTopology: true
}).then(() => console.log('Connected to db ')).catch(err => {
  console.log(err);
  throw new Error('Error to connect to db ');
});

app.use((0, _koaBody.default)()).use(router.routes()).use(router.allowedMethods());
app.listen(env.api.port, () => console.log(`server running in port ${env.api.port}`));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJlbnYiLCJFTlYiLCJhcHAiLCJLb2EiLCJyb3V0ZXIiLCJSb3V0ZXIiLCJkYiIsInVzZXIiLCJ1bmRlZmluZWQiLCJwYXNzd29yZCIsInBvcnQiLCJFcnJvciIsIkVSUk9SIiwiTUlTU0lOR19FTlZfVkFSSUFCTEVTIiwibW9uZ29vc2UiLCJjb25uZWN0IiwidXNlTmV3VXJsUGFyc2VyIiwidXNlVW5pZmllZFRvcG9sb2d5IiwidGhlbiIsImNvbnNvbGUiLCJsb2ciLCJjYXRjaCIsImVyciIsInVzZSIsImJvZHlQYXJzZXIiLCJyb3V0ZXMiLCJhbGxvd2VkTWV0aG9kcyIsImxpc3RlbiIsImFwaSJdLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSAnbW9uZ29vc2UnO1xuaW1wb3J0IGJvZHlQYXJzZXIgZnJvbSAna29hLWJvZHknO1xuaW1wb3J0IEtvYSBmcm9tICdrb2EnO1xuaW1wb3J0IFJvdXRlciBmcm9tICcuL3JvdXRlcyc7XG5pbXBvcnQgRU5WIGZyb20gJy4vY29uZmlnL2Vudmlyb21lbnQnO1xuaW1wb3J0IEVSUk9SIGZyb20gJy4vY29uZmlnL2Vycm9ycyc7XG5cbmNvbnN0IGVudiA9IEVOVigpO1xuXG5jb25zdCBhcHAgPSBuZXcgS29hKCk7XG5jb25zdCByb3V0ZXIgPSBSb3V0ZXIoKTtcbmlmIChlbnYuZGIudXNlciA9PT0gdW5kZWZpbmVkIHx8IGVudi5kYi5wYXNzd29yZCA9PT0gdW5kZWZpbmVkIHx8IGVudi5kYi5wb3J0ID09PSB1bmRlZmluZWQpIHtcbiAgdGhyb3cgbmV3IEVycm9yKEVSUk9SLk1JU1NJTkdfRU5WX1ZBUklBQkxFUyk7XG59XG5cbm1vbmdvb3NlXG4gIC5jb25uZWN0KGBtb25nb2RiOi8vJHtlbnYuZGIudXNlcn06JHtlbnYuZGIucGFzc3dvcmR9QG1vbmdvOiR7ZW52LmRiLnBvcnR9L2AsIHtcbiAgICB1c2VOZXdVcmxQYXJzZXI6IHRydWUsXG4gICAgdXNlVW5pZmllZFRvcG9sb2d5OiB0cnVlLFxuICB9IGFzIG1vbmdvb3NlLkNvbm5lY3RPcHRpb25zKVxuICAudGhlbigoKSA9PiBjb25zb2xlLmxvZygnQ29ubmVjdGVkIHRvIGRiICcpKVxuICAuY2F0Y2goZXJyID0+IHtcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIHRocm93IG5ldyBFcnJvcignRXJyb3IgdG8gY29ubmVjdCB0byBkYiAnKTtcbiAgfSk7XG5cbmFwcFxuICAudXNlKGJvZHlQYXJzZXIoKSlcbiAgLnVzZShyb3V0ZXIucm91dGVzKCkpLnVzZShyb3V0ZXIuYWxsb3dlZE1ldGhvZHMoKSk7XG5cbmFwcC5saXN0ZW4oXG4gIGVudi5hcGkucG9ydCxcbiAgKCkgPT4gY29uc29sZS5sb2coYHNlcnZlciBydW5uaW5nIGluIHBvcnQgJHtlbnYuYXBpLnBvcnR9YCksXG4pO1xuIl0sIm1hcHBpbmdzIjoiOztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBRUEsTUFBTUEsR0FBRyxHQUFHLElBQUFDLG1CQUFBLEdBQVo7QUFFQSxNQUFNQyxHQUFHLEdBQUcsSUFBSUMsWUFBSixFQUFaO0FBQ0EsTUFBTUMsTUFBTSxHQUFHLElBQUFDLGVBQUEsR0FBZjs7QUFDQSxJQUFJTCxHQUFHLENBQUNNLEVBQUosQ0FBT0MsSUFBUCxLQUFnQkMsU0FBaEIsSUFBNkJSLEdBQUcsQ0FBQ00sRUFBSixDQUFPRyxRQUFQLEtBQW9CRCxTQUFqRCxJQUE4RFIsR0FBRyxDQUFDTSxFQUFKLENBQU9JLElBQVAsS0FBZ0JGLFNBQWxGLEVBQTZGO0VBQzNGLE1BQU0sSUFBSUcsS0FBSixDQUFVQyxlQUFBLENBQU1DLHFCQUFoQixDQUFOO0FBQ0Q7O0FBRURDLGlCQUFBLENBQ0dDLE9BREgsQ0FDWSxhQUFZZixHQUFHLENBQUNNLEVBQUosQ0FBT0MsSUFBSyxJQUFHUCxHQUFHLENBQUNNLEVBQUosQ0FBT0csUUFBUyxVQUFTVCxHQUFHLENBQUNNLEVBQUosQ0FBT0ksSUFBSyxHQUQ1RSxFQUNnRjtFQUM1RU0sZUFBZSxFQUFFLElBRDJEO0VBRTVFQyxrQkFBa0IsRUFBRTtBQUZ3RCxDQURoRixFQUtHQyxJQUxILENBS1EsTUFBTUMsT0FBTyxDQUFDQyxHQUFSLENBQVksa0JBQVosQ0FMZCxFQU1HQyxLQU5ILENBTVNDLEdBQUcsSUFBSTtFQUNaSCxPQUFPLENBQUNDLEdBQVIsQ0FBWUUsR0FBWjtFQUNBLE1BQU0sSUFBSVgsS0FBSixDQUFVLHlCQUFWLENBQU47QUFDRCxDQVRIOztBQVdBVCxHQUFHLENBQ0FxQixHQURILENBQ08sSUFBQUMsZ0JBQUEsR0FEUCxFQUVHRCxHQUZILENBRU9uQixNQUFNLENBQUNxQixNQUFQLEVBRlAsRUFFd0JGLEdBRnhCLENBRTRCbkIsTUFBTSxDQUFDc0IsY0FBUCxFQUY1QjtBQUlBeEIsR0FBRyxDQUFDeUIsTUFBSixDQUNFM0IsR0FBRyxDQUFDNEIsR0FBSixDQUFRbEIsSUFEVixFQUVFLE1BQU1TLE9BQU8sQ0FBQ0MsR0FBUixDQUFhLDBCQUF5QnBCLEdBQUcsQ0FBQzRCLEdBQUosQ0FBUWxCLElBQUssRUFBbkQsQ0FGUiJ9